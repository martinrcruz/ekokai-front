<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Configuración del Sistema</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="guardarConfiguracion()" class="save-button">
        <i class="bi bi-check-circle-fill"></i>
        Guardar
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="configuracion-container">
    <!-- Header de la página -->
    <div class="page-header">
      <div class="header-content">
        <div class="header-icon">
          <i class="bi bi-gear-fill"></i>
        </div>
        <div class="header-text">
          <h1>Configuración del Sistema</h1>
          <p>Gestiona la configuración general de la aplicación Ekokai</p>
        </div>
      </div>
    </div>

    <!-- Configuración General -->
    <ion-card class="config-card">
      <ion-card-header class="card-header-primary">
        <ion-card-title>
          <ion-icon name="business-outline"></ion-icon>
          Información de la Empresa
        </ion-card-title>
        <ion-card-subtitle>Datos básicos de la organización</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <div class="form-grid">
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="business-outline"></ion-icon>
              Nombre de la Empresa
            </ion-label>
            <ion-input [(ngModel)]="configuracion.general.nombreEmpresa" placeholder="Ekokai" class="form-input"></ion-input>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="mail-outline"></ion-icon>
              Email de Contacto
            </ion-label>
            <ion-input [(ngModel)]="configuracion.general.emailContacto" type="email" placeholder="contacto@ekokai.com" class="form-input"></ion-input>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="call-outline"></ion-icon>
              Teléfono
            </ion-label>
            <ion-input [(ngModel)]="configuracion.general.telefono" placeholder="+34 123 456 789" class="form-input"></ion-input>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="location-outline"></ion-icon>
              Dirección
            </ion-label>
            <ion-input [(ngModel)]="configuracion.general.direccion" placeholder="Calle Principal 123, Madrid" class="form-input"></ion-input>
          </ion-item>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Configuración de Tokens -->
    <ion-card class="config-card">
      <ion-card-header class="card-header-success">
        <ion-card-title>
          <ion-icon name="star-outline"></ion-icon>
          Sistema de Tokens
        </ion-card-title>
        <ion-card-subtitle>Configuración de la economía interna</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <div class="form-grid">
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="trending-up-outline"></ion-icon>
              Tokens por Kilo
            </ion-label>
            <ion-input [(ngModel)]="configuracion.tokens.tokensPorKilo" type="number" placeholder="10" class="form-input"></ion-input>
            <ion-note slot="helper">Cantidad de tokens otorgados por cada kilo de residuo</ion-note>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="wallet-outline"></ion-icon>
              Tokens Mínimos para Retiro
            </ion-label>
            <ion-input [(ngModel)]="configuracion.tokens.tokensMinimosRetiro" type="number" placeholder="100" class="form-input"></ion-input>
            <ion-note slot="helper">Mínimo de tokens necesarios para canjear premios</ion-note>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="speedometer-outline"></ion-icon>
              Máximo Tokens por Día
            </ion-label>
            <ion-input [(ngModel)]="configuracion.tokens.maxTokensPorDia" type="number" placeholder="500" class="form-input"></ion-input>
            <ion-note slot="helper">Límite diario de tokens por usuario</ion-note>
          </ion-item>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Configuración de Notificaciones -->
    <ion-card class="config-card">
      <ion-card-header class="card-header-info">
        <ion-card-title>
          <ion-icon name="notifications-outline"></ion-icon>
          Sistema de Notificaciones
        </ion-card-title>
        <ion-card-subtitle>Gestiona las alertas y comunicaciones</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <div class="toggle-grid">
          <ion-item class="toggle-item">
            <ion-label>
              <div class="toggle-label">
                <ion-icon name="mail-outline"></ion-icon>
                <span>Notificaciones por Email</span>
              </div>
              <p>Enviar alertas por correo electrónico</p>
            </ion-label>
            <ion-toggle [(ngModel)]="configuracion.notificaciones.emailActivo" class="custom-toggle"></ion-toggle>
          </ion-item>
          <ion-item class="toggle-item">
            <ion-label>
              <div class="toggle-label">
                <ion-icon name="phone-portrait-outline"></ion-icon>
                <span>Notificaciones Push</span>
              </div>
              <p>Alertas en tiempo real en dispositivos móviles</p>
            </ion-label>
            <ion-toggle [(ngModel)]="configuracion.notificaciones.pushActivo" class="custom-toggle"></ion-toggle>
          </ion-item>
          <ion-item class="toggle-item">
            <ion-label>
              <div class="toggle-label">
                <ion-icon name="time-outline"></ion-icon>
                <span>Recordatorios</span>
              </div>
              <p>Recordatorios automáticos de actividades</p>
            </ion-label>
            <ion-toggle [(ngModel)]="configuracion.notificaciones.recordatorios" class="custom-toggle"></ion-toggle>
          </ion-item>
          <ion-item class="toggle-item">
            <ion-label>
              <div class="toggle-label">
                <ion-icon name="analytics-outline"></ion-icon>
                <span>Reportes Automáticos</span>
              </div>
              <p>Generación automática de reportes</p>
            </ion-label>
            <ion-toggle [(ngModel)]="configuracion.notificaciones.reportes" class="custom-toggle"></ion-toggle>
          </ion-item>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Configuración de Seguridad -->
    <ion-card class="config-card">
      <ion-card-header class="card-header-warning">
        <ion-card-title>
          <ion-icon name="shield-checkmark-outline"></ion-icon>
          Configuración de Seguridad
        </ion-card-title>
        <ion-card-subtitle>Parámetros de autenticación y protección</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <div class="form-grid">
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="timer-outline"></ion-icon>
              Timeout de Sesión (minutos)
            </ion-label>
            <ion-input [(ngModel)]="configuracion.seguridad.sesionTimeout" type="number" placeholder="30" class="form-input"></ion-input>
            <ion-note slot="helper">Tiempo de inactividad antes de cerrar sesión</ion-note>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="lock-closed-outline"></ion-icon>
              Intentos Máximos de Login
            </ion-label>
            <ion-input [(ngModel)]="configuracion.seguridad.intentosMaximos" type="number" placeholder="3" class="form-input"></ion-input>
            <ion-note slot="helper">Número de intentos antes de bloquear cuenta</ion-note>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="key-outline"></ion-icon>
              Longitud Mínima de Contraseña
            </ion-label>
            <ion-input [(ngModel)]="configuracion.seguridad.passwordMinLength" type="number" placeholder="8" class="form-input"></ion-input>
            <ion-note slot="helper">Caracteres mínimos requeridos</ion-note>
          </ion-item>
        </div>
        <div class="toggle-grid">
          <ion-item class="toggle-item">
            <ion-label>
              <div class="toggle-label">
                <ion-icon name="text-outline"></ion-icon>
                <span>Requerir Mayúsculas</span>
              </div>
              <p>Contraseñas deben incluir letras mayúsculas</p>
            </ion-label>
            <ion-toggle [(ngModel)]="configuracion.seguridad.requiereMayusculas" class="custom-toggle"></ion-toggle>
          </ion-item>
          <ion-item class="toggle-item">
            <ion-label>
              <div class="toggle-label">
                <ion-icon name="calculator-outline"></ion-icon>
                <span>Requerir Números</span>
              </div>
              <p>Contraseñas deben incluir números</p>
            </ion-label>
            <ion-toggle [(ngModel)]="configuracion.seguridad.requiereNumeros" class="custom-toggle"></ion-toggle>
          </ion-item>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Configuración de Ecopuntos -->
    <ion-card class="config-card">
      <ion-card-header class="card-header-primary">
        <ion-card-title>
          <ion-icon name="location-outline"></ion-icon>
          Gestión de Ecopuntos
        </ion-card-title>
        <ion-card-subtitle>Configuración de ubicaciones de reciclaje</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <div class="form-grid">
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="navigate-outline"></ion-icon>
              Radio Máximo (km)
            </ion-label>
            <ion-input [(ngModel)]="configuracion.ecopuntos.radioMaximo" type="number" placeholder="5" class="form-input"></ion-input>
            <ion-note slot="helper">Distancia máxima para mostrar ecopuntos cercanos</ion-note>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="sunny-outline"></ion-icon>
              Horario de Apertura
            </ion-label>
            <ion-input [(ngModel)]="configuracion.ecopuntos.horarioApertura" type="time" class="form-input"></ion-input>
            <ion-note slot="helper">Hora de apertura diaria</ion-note>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="moon-outline"></ion-icon>
              Horario de Cierre
            </ion-label>
            <ion-input [(ngModel)]="configuracion.ecopuntos.horarioCierre" type="time" class="form-input"></ion-input>
            <ion-note slot="helper">Hora de cierre diario</ion-note>
          </ion-item>
          <ion-item class="form-item">
            <ion-label position="stacked">
              <ion-icon name="people-outline"></ion-icon>
              Máximo Usuarios por Ecopunto
            </ion-label>
            <ion-input [(ngModel)]="configuracion.ecopuntos.maxUsuariosPorEcopunto" type="number" placeholder="100" class="form-input"></ion-input>
            <ion-note slot="helper">Límite de usuarios simultáneos</ion-note>
          </ion-item>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- Acciones del Sistema -->
    <ion-card class="config-card">
      <ion-card-header class="card-header-secondary">
        <ion-card-title>
          <ion-icon name="construct-outline"></ion-icon>
          Mantenimiento del Sistema
        </ion-card-title>
        <ion-card-subtitle>Herramientas de administración y respaldo</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <div class="actions-grid">
          <ion-button expand="block" fill="outline" (click)="exportarConfiguracion()" class="action-button export">
            <i class="bi bi-download"></i>
            Exportar Configuración
          </ion-button>
          <ion-button expand="block" fill="outline" (click)="importarConfiguracion()" class="action-button import">
            <i class="bi bi-upload"></i>
            Importar Configuración
          </ion-button>
          <ion-button expand="block" fill="outline" (click)="generarBackup()" class="action-button backup">
            <i class="bi bi-save-fill"></i>
            Generar Backup
          </ion-button>
          <ion-button expand="block" fill="outline" (click)="restaurarBackup()" class="action-button restore">
            <i class="bi bi-arrow-clockwise"></i>
            Restaurar Backup
          </ion-button>
          <ion-button expand="block" fill="outline" color="warning" (click)="resetearConfiguracion()" class="action-button reset">
            <i class="bi bi-arrow-repeat"></i>
            Resetear Configuración
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content> 